# WhatsApp Video Generator Microservice

A Docker-based microservice that generates WhatsApp-style videos with custom conversations, TTS audio, and background videos.

## ğŸ—ï¸ Architecture

- **Python**: Orchestrates the pipeline (chat generation, TTS, video creation)
- **Node.js**: Generates WhatsApp-style images using Puppeteer
- **Docker**: Runs both services in a single container

## ğŸš€ Quick Start

### 1. Set Environment Variables
```bash
export OPENAI_API_KEY="your-openai-api-key-here"
```

### 2. Build and Run with Docker Compose
```bash
# Build and run with default prompt
docker-compose up --build

# Or run with custom prompt
docker-compose run --rm whatsapp-video-generator --prompt "Uma conversa engraÃ§ada sobre programaÃ§Ã£o"
```

### 3. Run with Docker Directly
```bash
# Build the image
docker build -t whatsapp-video-generator .

# Run with custom prompt
docker run --rm \
  -e OPENAI_API_KEY="$OPENAI_API_KEY" \
  -v $(pwd)/output:/app/video_generator/output \
  -v $(pwd)/background_videos:/app/background_videos \
  whatsapp-video-generator \
  --prompt "Uma conversa engraÃ§ada sobre tecnologia"
```

## ğŸ“ Project Structure

```
makeMoney/
â”œâ”€â”€ Dockerfile                 # Multi-stage Docker build
â”œâ”€â”€ docker-compose.yml         # Docker Compose configuration
â”œâ”€â”€ .dockerignore             # Docker ignore file
â”œâ”€â”€ whatsapp-clone/           # Node.js microservice
â”‚   â”œâ”€â”€ src/server.ts         # Express API server
â”‚   â””â”€â”€ package.json          # Node.js dependencies
â”œâ”€â”€ video_generator/          # Python orchestrator
â”‚   â”œâ”€â”€ main.py              # Main pipeline
â”‚   â””â”€â”€ requirements.txt     # Python dependencies
â”œâ”€â”€ background_videos/        # Background videos (mounted)
â””â”€â”€ output/                  # Generated videos (mounted)
```

## ğŸ¯ Usage Examples

### Basic Usage
```bash
docker-compose run --rm whatsapp-video-generator
```

### Custom Prompt
```bash
docker-compose run --rm whatsapp-video-generator \
  --prompt "Uma conversa engraÃ§ada sobre programaÃ§Ã£o e bugs"
```

### Custom Participants
```bash
docker-compose run --rm whatsapp-video-generator \
  --prompt "Uma conversa sobre futebol" \
  --participants "JoÃ£o" "Maria"
```

## ğŸ“‹ API Endpoints

The Node.js server exposes:
- `POST /generate-images` - Generate WhatsApp images from messages
- `GET /health` - Health check

## ğŸ”§ Configuration

### Environment Variables
- `OPENAI_API_KEY` - Required for chat generation

### Command Line Arguments
- `--prompt` - Custom conversation prompt
- `--participants` - Participant names (default: Ana, Bruno)

### Volumes
- `./output` - Generated videos
- `./background_videos` - Background video files

## ğŸ¬ Output

The service generates:
1. **WhatsApp chat JSON** - Generated by OpenAI
2. **TTS audio files** - Portuguese audio for each message
3. **WhatsApp images** - Progressive images generated by Node.js
4. **Final video** - Combined with background video and TTS

## ğŸ› Troubleshooting

### Node.js Server Not Starting
```bash
# Check if port 3001 is available
docker-compose logs whatsapp-video-generator
```

### Missing Dependencies
```bash
# Rebuild the container
docker-compose build --no-cache
```

### OpenAI API Issues
```bash
# Verify API key
echo $OPENAI_API_KEY
```

## ğŸ”„ Development

### Local Development
```bash
# Start Node.js server
cd whatsapp-clone && npm run server

# Start Python pipeline
cd video_generator && python main.py --prompt "Your prompt here"
```

### Rebuilding
```bash
docker-compose build --no-cache
docker-compose up
``` 